'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.gql = gql;

var _graphqlTag = require('graphql-tag');

var _graphqlTag2 = _interopRequireDefault(_graphqlTag);

var _printer = require('graphql-tag/printer');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var fragmentIdCounter = 0;

function gql(strings) {
  var fragmentsString = '';

  for (var _len = arguments.length, fragments = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    fragments[_key - 1] = arguments[_key];
  }

  var fragmentsForParser = fragments.map(function (fragment) {
    if (!fragment.definitions[0].name.__isUnique) {
      fragment.definitions[0].name.value += '__' + (fragmentIdCounter++).toString();
      fragment.definitions[0].name.__isUnique = true;
    }

    var name = fragment.definitions[0].name.value;

    fragmentsString += (0, _printer.print)(fragment);

    return '\n...' + name + '\n';
  });

  var forParser = '';

  for (var i = 0; i < strings.length; i++) {
    forParser += strings[i];
    if (fragmentsForParser[i]) forParser += fragmentsForParser[i];
  }

  forParser += fragmentsString;

  return (0, _graphqlTag2.default)([forParser]);
}